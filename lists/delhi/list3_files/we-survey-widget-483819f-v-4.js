var $SurveyWidgetInitializer = typeof(document.$SurveyWidgetInitializer) != "undefined" ? document.$SurveyWidgetInitializer
: (window.parent.document.$SurveyWidgetInitializer);

$weJQuery.alignLayout=function(b,g,e){var f=b.alignment;f=(f?(f==="BOTTOM_RIGHT"?"right":"left"):"left");var a=e.height,c=e.width;var d=g.style;if("right"==f){d.right="0px"}else{d.left="10px"}d.height=a;d.width=c;d.zIndex=(webengage.util.getMaxZIndex()+1);d.position=(webengage.BrowserDetect.is_this_the_worlds_most_annoying_browser()?"absolute":"fixed");d.backgroundColor="transparent";d.bottom="0px";d.display="block";$weJQuery.resizeIframe=function(h,i){d.height=(h+20)+"px";d.width=(i+20)+"px"}};webengage.setTimeout(function(){(function(b,a,c){c.fixFlashBleed=function(){try{c("object:not(:has(wmode))").each(function(){try{if(!c('param[name="wmode"]',this).length){c(this).prepend('<param name="wmode" value="transparent">')}else{if(!c('param[name="wmode"][value="transparent"], param[name="wmode"][value="opaque"]',this).length){c('param[name="wmode"]',this).each(function(){c(this).attr("value","transparent")})}}if(!c('embed[wmode="opaque"], embed[wmode="transparent"]',this).length){c("embed",this).attr("wmode","transparent")}}catch(f){}})}catch(d){}};c.loadSurveyForm=function(){var w=$SurveyWidgetInitializer.containerId,p=$SurveyWidgetInitializer.licenseCode,H=$SurveyWidgetInitializer.appHost,j=$SurveyWidgetInitializer.width,e=$SurveyWidgetInitializer.currentInstance,C=e.layoutAttributes,r=e.surveyEId,t=e.theme,D=(typeof e.showOnExit==="boolean"?e.showOnExit:false),n=e._surveyOptions.customData||{},k=(typeof(e._surveyOptions.forcedRender)=="boolean"?e._surveyOptions.forcedRender:false),B=(typeof(e._surveyOptions.isDemoMode)=="boolean"?e._surveyOptions.isDemoMode:false),x=(e.scope!==undefined&&e.scope?e.scope:""),G=(e.scopeType!==undefined&&e.scopeType?e.scopeType:""),d=(typeof(e._surveyOptions.enableCallbacks)=="boolean"?e._surveyOptions.enableCallbacks:false),g=a.getElementById(w+"-survey-content"),i=b.location.href,q=a.title,y=e.cssUrl,o={surveyId:r,licenseCode:p,activity:webengage.getUser(),type:"survey"};if(!B){var m=webengage.util.getTotalTimesShown(r,"survey")}g.style.zIndex=webengage.util.getMaxZIndex()+1;g.style.display="block";c.fixFlashBleed();var I=false;var v=false;var A="we-survey-callback-frame";var l="//"+H+"/widget/callback.htm?v=2";var K=function(N,R){if(typeof R.height!=="undefined"){c.resizeIframe(R.height,R.width)}var Q=webengage.util.copy({},o);if(typeof(R.response)==="object"){webengage.util.copy(Q,R.response)}switch(N){case"getScrollTop":if(b.postMessage){b.frames[w+"-survey-frame"].postMessage('{ "scrollTop" : '+c(b).scrollTop()+"}","*")}break;case"success":v=true;s();break;case"submit":case"complete":e.event=N;if(r&&!k&&!B){webengage.util.markSurveyAsTaken(r,e,true)}e.executeCallbacks(N,Q);break;case"close":e.close(true);break;case"open":if(!I){I=true;webengage.util.markEntityAsShown(r,"survey",e);if(!D){e.executeCallbacks("open",Q);e.dump("view")}else{g.style.display="none"}}break;case"redirect":var M=R.response.redirectURL;var P=R.response.urlDestination;if(P==="TOP"){b.location.href=M}else{if(P==="_BLANK"){b.open(M,"_blank")}}break;case"error":webengage.survey.clear();if(I){var O="Something went wrong while registering your question response. Apologies for the inconvenience.";webengage.logger.error(O+".")}break;default:break}};webengage.survey.callbackWrapper=function(M){webengage.withELog(function(){var N=webengage.util.parseJSON(M);K(N.eventName,N.data)})};var u;if(typeof b.postMessage!=="undefined"){u=webengage.IFRAMES.create(A,g);u.style.display="none";webengage.setTimeout(function(){var M=null;if(u.contentDocument){M=u.contentDocument}else{if(u.contentWindow){M=u.contentWindow.document}else{if(u.document){M=u.document}}}M.open();M.write('<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html><head><meta http-equiv="cache-control" content="max-age=0" /><meta http-equiv="cache-control" content="no-cache" /><meta http-equiv="pragma" content="no-cache" /><meta http-equiv="content-type" content="text/html; charset=utf-8"><script type="text/javascript">try{window.parent.window.name}catch(e){document.domain="'+a.domain+'";}; setTimeout(function(){if (window.attachEvent) {window.attachEvent( "onmessage", function (e) { if(e.origin !== "'+b.location.protocol+"//"+H+'"){ return; } window.parent.window.webengage.survey.callbackWrapper(e.data);},false);} else {window.addEventListener( "message", function (e) { if(e.origin !== "'+b.location.protocol+"//"+H+'"){ return; } window.parent.window.webengage.survey.callbackWrapper(e.data);},false);}},10);<\/script></head><body></body></html>');M.close()},10)}else{widgetCallBackFrame=webengage.IFRAMES.creatCallbackFrame(A,g,l,K)}c.alignLayout(C,g,e);var E=c(webengage.IFRAMES.create(w+"-survey-frame",g));E.css({height:"100%",width:"100%",position:"relative",display:"none",bottom:"0px",visibility:"visible",left:"0px"});var L="//"+H+"/mini-survey.html?action=edit&surveyEId="+r+"&licenseCode="+p+"&events=open&widgetVersion="+webengage.util.getVersion()+(x?"&scope="+x:"")+(G?"&scopeType="+G:"")+"&width="+j+"&pageUrl="+encodeURIComponent(i)+(y!==undefined&&y?"&cssUrl="+encodeURIComponent(y):"")+"&theme="+encodeURIComponent(t)+"&pageTitle="+encodeURIComponent(q.length>150?q.substring(0,147)+"...":q)+"&timesShown="+m+"&enableCallbacks="+d+"&defaultTracking="+!D+"&r="+Math.random();var f={};if(n){f=webengage.util.copy({},n)}L+="&clientDataString="+encodeURIComponent(webengage.util.clientDataString(f));if(B){L+="&demo="+B}E.attr("src",L);E.css("opacity",0);var h=a.getElementById(w+"-survey-close-div"),z=a.getElementById(w+"-survey-minimize-div");var F=false;function J(){c("body").unbind("mouseleave.webengage_exit_survey").unbind("mousemove.webengage_exit_survey");g.style.width=j;g.style.display="block";if((c.browser.msie&&(c.browser.version=="8.0"||c.browser.version=="7.0"))){c.alignLayout(C,g,e)}E.animate({opacity:1},"slow");if(h){c(h).show();h.style.zIndex=webengage.util.getMaxZIndex()+2}if(z){c(z).show();z.style.zIndex=webengage.util.getMaxZIndex()+2}if(!F){F=true}if(c.layoutOpen){c.layoutOpen()}if(D){c.ajax({url:"//"+H+"/track/survey.html?action=track",dataType:"jsonp",data:{surveyEId:r,act:"view",licenseCode:p}});e.executeCallbacks("open",o);e.dump("view")}}e.show=function(){J();return this};e.updateCustomData=function(M){if(M){if(typeof b.postMessage!=="undefined"){e._surveyOptions.customData=M;E.get(0).contentWindow.postMessage("{'action':'changeData', 'data':'"+webengage.util.clientDataString(M)+"'}","*")}else{}}return this};var s=function(M){webengage.withELog(function(){if(v){if(!F){e.executeCallbacks("load",o)}if(D){if(!webengage.BrowserDetect.isMobile()){var N={x:0,y:0};c("body").bind("mouseleave.webengage_exit_survey",function(Q){Q=Q?Q:b.event;var P=Q.relatedTarget||Q.toElement;var O=c(b).height()/5;if((!P||P.nodeName=="HTML")&&Q.clientY<=0&&(N.y<=0||N.y<O)){e.show()}}).bind("mousemove.webengage_exit_survey",function(O){N.x=O.clientX;N.y=O.clientY})}}else{e.show()}}else{c.renderErrorMsg()}})};E.get(0).style.display="block";e.close=function(M){e.show=null;webengage.IFRAMES.remove(A);webengage.IFRAMES.remove(w+"-survey-frame");if(g){c(g).remove()}if(typeof M==="boolean"&&M){if(r&&!k&&!B){webengage.util.markSurveyAsClosed(r+(x&&(!G||(G+"").toUpperCase()!="GLOBAL"?"["+webengage.util.escapeScopeChars(x)+"]":"")),e)}this.executeCallbacks("close",o)}if(c.layoutClose){c.layoutClose()}};if(h){h.onclick=function(){webengage.withELog(function(){e.close(true);return false})}}};c.loadSurveyForm()}(window,window.document,$weJQuery))},10);